- completly rewrited in PLD style (compiles now).
